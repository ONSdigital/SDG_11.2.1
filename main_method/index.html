<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://sdg-11-2-1.github.io/main_method/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Main method - SDG 11.2.1 Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Main method";
        var mkdocs_page_input_path = "main_method.md";
        var mkdocs_page_url = "/main_method/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> SDG 11.2.1 Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../data_quality/">Data Quality</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../data_description/">Data Description</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../methodology.md">Methodology</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../comparison_to_EU_method/">EU and UK Methodology Comparison</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Developers Guide</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../for_developers/">For Developers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="#">Code Reference</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../main/">Main</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../data_ingest/">Data ingest</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../data_output/">Data output</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../data_transform/">Data transform</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../geospatial_mods/">Geospatial mods</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../SDG_NI/">SDG NI</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../SDG_scotland/">SDG scotland</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="#">Time Table</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../SDG_bus_timetable/">SDG bus timetable</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../SDG_train_timetable/">SDG train timetable</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../time_table_utils/">Time table utils</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../building_docs/">Using mkdocs to edit these pages</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">SDG 11.2.1 Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Main method</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/ONSdigital/SDG_11.2.1/edit/master/docs/main_method.md">Edit on SDG 11.2.1</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="calculation-process">Calculation process</h2>
<h2 id="process-diagram">Process diagram</h2>
<p><a href="../img/New_workflow_diagram.png"><img alt="process_diag" src="../img/New_workflow_diagram.png" /></a></p>
<h2 id="main-method-of-calculation">Main method of calculation</h2>
<p>The key step of calculation is a spatial join between geolocated urban population data and public transport service areas. A discussion of how each component of that join was calculated from their component parts follows. </p>
<h2 id="geocoding-the-population-data">Geocoding the population data</h2>
<p>The questions we are trying to answer in this analysis is “What proportion of people in the UK have access to public transport access points from their home?”. And then the same question for people in each age, sex and disability category. </p>
<p>To make the calculation as accurate as possible, we sourced the most granularly geolocated population data possible. Ideally, this would have been right down to the individual place of living (house/flat etc.) but such granularity is not available publicly, as it would be disclosive of individuals’ living situations. The most granular level published that we are currently aware of is the “output area” (OA) data, which derives from the census. </p>
<p>Output areas (more fully defined and discussed in the data section of this methodology write up) are a conglomerate of the postcodes. Those postcodes are joined together on the basis that they are:</p>
<ol>
<li>Adjacent</li>
<li>Of the same urban/rural classification</li>
</ol>
<p>In order to calculate the distance from the place any person lives, to a public transport access node (station or stop) we need a point-geometry for their residence. As we cannot geolocate individual residencies, we used an approximation in the form of population weighted centroids (PWCs). </p>
<p>PWCs are a population-weighted location (x,y point) at which is a geospatial mean of the locations of all residences in that output area. The PWC, while extremely helpful in giving us a geospatial point to define where the population of any output area lives, is an approximation and is only used due to limitations in our data. </p>
<h3 id="joining-the-data">Joining the data</h3>
<p>Population weighted centroid (PWC) data is geolocated with x,y coordinates and has a common data column with the output area data (output area code, “OA11CD”) so a table join can be performed on those datasets. Then the entire population of any output area is approximated to live at the centroid.</p>
<h3 id="limitations-and-improvements">Limitations and improvements</h3>
<p>Our team recognises that PWCs do not accurately represent the location of any individual’s place of residence and we intend to  research methods of making calculations at even more granular levels, such as postcodes or smaller. Currently however we agreed with the our data end user and the geospatial department that the method to be used for version 1.0 will use the described approximation to geolocate the population.</p>
<h3 id="disaggregated-data">Disaggregated data</h3>
<p>We disaggregate our data into age, sex, and disability. For all years aside from Census years (2011, 2021), we don't have disability data. Thus we calculated the proportions of people classified as disabled and not disabled in all output areas and applied this proportion to population estimates for non-Census years (2011, 2021). Similarly, Scotland and Northern Ireland do not have sex and Age data available for non-Census years. We used a similar method calculating proportions of people for a given age group or sex and applied these proportions to the mid-year population estimates for that output area.</p>
<h3 id="delimitation-of-urban-areas">Delimitation of urban areas</h3>
<p>As Target 11 is concerned with sustainable urban environments, we ultimately had to select only urban areas and exclude rural areas from our analysis. Urban areas are defined as Ordnance Survey mapping that have resident populations above 10,000 people (2011 Census) and the methodology is available <a href="https://www.ons.gov.uk/file?uri=/methodology/geography/geographicalproducts/ruralurbanclassifications/2011ruralurbanclassification/ruralurbanclassification2011userguide.zip">here</a>. The urban/rural lookup data was sourced from <a href="https://geoportal.statistics.gov.uk/">ONS’s Geography Portal </a>and it provides a classification of each output area as either urban or rural categories which are further subdivided as follows. </p>
<table>
  <tr>
   <td>Classification
   </td>
   <td>Description
   </td>
   <td>Code
   </td>
  </tr>
  <tr>
   <td>Urban
   </td>
   <td>Major Conurbation
   </td>
   <td>A1
   </td>
  </tr>
  <tr>
   <td>Urban
   </td>
   <td>Minor Conurbation
   </td>
   <td>B1
   </td>
  </tr>
  <tr>
   <td>Urban
   </td>
   <td>City and Town
   </td>
   <td>C1
   </td>
  </tr>
  <tr>
   <td>Urban
   </td>
   <td>City and Town in a Sparse Setting
   </td>
   <td>C2
   </td>
  </tr>
  <tr>
   <td>Rural
   </td>
   <td>Town and Fringe
   </td>
   <td>D1
   </td>
  </tr>
  <tr>
   <td>Rural
   </td>
   <td>Town and Fringe in a Sparse Setting
   </td>
   <td>D2
   </td>
  </tr>
  <tr>
   <td>Rural
   </td>
   <td>Village
   </td>
   <td>E1
   </td>
  </tr>
  <tr>
   <td>Rural
   </td>
   <td>Village in a Sparse Setting
   </td>
   <td>E2
   </td>
  </tr>
  <tr>
   <td>Rural
   </td>
   <td>Hamlets and Isolated Dwellings
   </td>
   <td>F1
   </td>
  </tr>
  <tr>
   <td>Rural
   </td>
   <td>Hamlets and Isolated Dwellings in a Sparse Setting 
   </td>
   <td>F2
   </td>
  </tr>
</table>

<p>In our calculation we group A1, B1, C1 and C2 as urban and any other code as rural. </p>
<h3 id="joining-the-data_1">Joining the data</h3>
<p>The population table for the whole nation was joined onto the table with the urban/rural classification for each output area on the output area code “OA11CD”, hence bringing in the classification into the population data. Every OA and associated PWC is therefore categorised as either urban or rural. Later we use this classification to filter the data, and disaggregate our analysis. For the SDG analysis we remove the OAs classified as rural from our analysis, but we can choose to include them to expose transport availability in rural areas too. </p>
<h2 id="computation-of-service-areas">Computation of service areas</h2>
<p>As described in the methodology of the UN Metadata for this indicator, public transport service areas had to be calculated.  Two methods to calculate service areas are described in the methodology:</p>
<p>1) using a Euclidean buffer to create polygon, and </p>
<p>2) to create a network/path calculation. </p>
<p>Our team opted for the Euclidean buffer method for a number of reasons:</p>
<ul>
<li>We followed advice from the ONS Geospatial department that the simpler buffering method would be adequate for our needs</li>
<li>Computationally Euclidean is would be much less resource intensive and does not require distributed compute power, whereas a network calculation would require scaled compute power.</li>
<li>Other countries (such as <a href="https://www.efgs.info/11-2-1-estonia/">Estonia</a>, <a href="https://www.efgs.info/11-2-1-norway-test-page/">Norway</a> and others) used the Euclidean buffer method and published their results. Our results will be more comparable with theirs</li>
<li>Research shows that the network enquiry requires a complete path network, (as pointed out by <a href="https://www.efgs.info/11-2-1-sweden/">Sweden</a> in their write up, see section “<strong>Result from the network distance calculations”</strong>)</li>
</ul>
<h3 id="euclidean-buffering-methodology">Euclidean buffering methodology</h3>
<p>We use Geopandas and for all geospatial operations in our analysis and the buffering operation is actually carried out by the Shapely <code>object.buffer()</code> function. This operation takes a geospatial point, and uses a radius of a given length to creates a polygon around the point which approximates a circle. The standard buffering of a point yields a polygon with 99.8% of the area of the circular disk it approximates.</p>
<p><img alt="Buffering geospatial points" src="../img/buffering_geospatial_point.png" /></p>
<p><strong>Figure 1: Illustration of the process of buffering a geospatial Point</strong></p>
<p>The resulting geospatial polygons are then joined and can be used for further calculations. </p>
<p><a href="../img/combining_buffers.png"><img alt="Combining polygons to make a multi-polygon" src="../img/combining_buffers.png" /></a></p>
<p><strong>Figure 2: Process of combining polygons to create the service area</strong></p>
<h2 id="network-query-method">Network query method</h2>
<p>A network query would be calculated by taking paths of a specified length (500m or 1km) in every direction from a specified point; for this project that point would be a transport stop or station. Following these paths for the specified distance would create many end points. Finally end points are joined to create a perimeter, within which lies the service area.</p>
<p><img alt="An example of a network distance calcualtion sourced from the Swedish methodology write up" src="../img/swedish_network_calculation.png" /></p>
<p><strong>Figure 3: An example visualisation of a network distance calculation, taken from the Swedish methodology write up at <a href="https://www.efgs.info/11-2-1-sweden/">https://www.efgs.info/11-2-1-sweden/</a>.</strong> The image shows the stops in blue, surrounded by the Euclidean buffer, shaded in green and a 500m limit shown. </p>
<h2 id="calculation-of-population-within-service-areas">Calculation of population within service areas</h2>
<p>With the service areas calculated, the population that resides within a service area is calculated by a two stage process:</p>
<ol>
<li>A points in polygons enquiry which then filters the PWCs, so that the data set contains only those which are within the service areas,</li>
<li>The population figure (number of individuals) associated with each PWC is summed, meaning that only the population within the service areas is counted as the population outside of the service areas was filtered out at stage 1.</li>
<li>The proportion of the population inside a service area is calculated as a proportion of the total population. Currently for version 1.0, this is carried out at Local Authority (LA) level.</li>
</ol>
<h2 id="timetable-method">Timetable method</h2>
<p>More information on the timetable method can be found under the 'Timetable method' section.</p>
<h3 id="northern-ireland">Northern Ireland</h3>
<p>Due to complexity of the work that will need to be undertaken, Northern Ireland timetable data will be included in Version 1.3 - enhanced functions and calculation. Currently, we will be using the stops sourced from NAPTAN. </p>
<h2 id="disaggregations">Disaggregations</h2>
<p>As required for the SDG indicator we are producing this data for, the output data from this project has been disaggregated by sex, age and disability status. </p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
